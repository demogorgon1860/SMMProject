# Kafka Server Properties for Production
# =======================================
# Version: Apache Kafka 3.4+ (Confluent Platform 7.4.0)
# Mode: Traditional (Zookeeper) or KRaft
# Last Updated: 2025-08-17

# =======================================
# Server Basics
# =======================================

# Broker ID must be unique across the cluster
broker.id=1

# Rack awareness (for multi-datacenter deployments)
# broker.rack=dc1

# =======================================
# Socket Server Settings
# =======================================

# Listeners - Network interfaces and ports
listeners=INTERNAL://0.0.0.0:29092,EXTERNAL://0.0.0.0:9092

# Advertised listeners - How clients connect
advertised.listeners=INTERNAL://kafka:29092,EXTERNAL://localhost:9092

# Security protocol map
listener.security.protocol.map=INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT

# Inter-broker communication
inter.broker.listener.name=INTERNAL

# Number of network threads
num.network.threads=8

# Number of I/O threads
num.io.threads=8

# Socket buffer sizes
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
socket.request.max.bytes=104857600

# Queue sizes
queued.max.requests=500

# =======================================
# Log Basics
# =======================================

# Log directories
log.dirs=/var/lib/kafka/data

# Number of partitions per topic (default)
num.partitions=3

# Recovery threads
num.recovery.threads.per.data.dir=2

# =======================================
# Internal Topic Settings
# =======================================

# Replication factors for internal topics
offsets.topic.replication.factor=1
transaction.state.log.replication.factor=1
transaction.state.log.min.isr=1

# =======================================
# Log Flush Policy
# =======================================

# Don't force flush (let OS handle it for better performance)
#log.flush.interval.messages=10000
#log.flush.interval.ms=1000

# =======================================
# Log Retention Policy
# =======================================

# Keep logs for 7 days
log.retention.hours=168

# Check for log deletion every 5 minutes
log.retention.check.interval.ms=300000

# Maximum log segment size
log.segment.bytes=1073741824

# =======================================
# Compression
# =======================================

# Compression type for topics
compression.type=snappy

# =======================================
# Zookeeper (for non-KRaft mode)
# =======================================

# Zookeeper connection
zookeeper.connect=zookeeper:2181

# Zookeeper timeout
zookeeper.connection.timeout.ms=6000

# Zookeeper session timeout
zookeeper.session.timeout.ms=18000

# =======================================
# Group Coordinator Settings
# =======================================

# Rebalance delay for new members
group.initial.rebalance.delay.ms=0

# Maximum session timeout
group.max.session.timeout.ms=1800000

# Minimum session timeout
group.min.session.timeout.ms=6000

# =======================================
# Replica Settings
# =======================================

# Replica lag settings
replica.lag.time.max.ms=30000
replica.socket.timeout.ms=30000
replica.socket.receive.buffer.bytes=65536

# Replica fetcher settings
replica.fetch.min.bytes=1
replica.fetch.wait.max.ms=500
replica.high.watermark.checkpoint.interval.ms=5000

# =======================================
# Leader Election
# =======================================

# Preferred leader election
auto.leader.rebalance.enable=true
leader.imbalance.per.broker.percentage=10
leader.imbalance.check.interval.seconds=300

# Unclean leader election (set to false for data safety)
unclean.leader.election.enable=false

# =======================================
# Controller Settings
# =======================================

# Controller socket timeout
controller.socket.timeout.ms=30000

# =======================================
# Security Settings
# =======================================

# Auto create topics (disabled for production)
auto.create.topics.enable=false

# Delete topics
delete.topic.enable=true

# =======================================
# Quotas
# =======================================

# Default quotas per client
#quota.consumer.default=10485760
#quota.producer.default=10485760

# =======================================
# Transaction Settings
# =======================================

# Transaction timeout
transaction.max.timeout.ms=900000

# Transaction state log settings
transaction.state.log.segment.bytes=104857600
transaction.state.log.load.buffer.size=5242880

# =======================================
# Metrics
# =======================================

# Metrics reporters
metric.reporters=

# Metrics recording level
metrics.recording.level=INFO

# Metrics sample window
metrics.sample.window.ms=30000
metrics.num.samples=2

# =======================================
# JMX Settings
# =======================================

# JMX port
#jmx.port=9999

# =======================================
# SSL/SASL Settings (for production)
# =======================================

# SSL configuration (uncomment for production)
#ssl.keystore.location=/var/ssl/private/kafka.keystore.jks
#ssl.keystore.password=
#ssl.key.password=
#ssl.truststore.location=/var/ssl/private/kafka.truststore.jks
#ssl.truststore.password=
#ssl.endpoint.identification.algorithm=https

# SASL configuration (uncomment for production)
#sasl.enabled.mechanisms=SCRAM-SHA-512
#sasl.mechanism.inter.broker.protocol=SCRAM-SHA-512

# =======================================
# Authorization (for production)
# =======================================

# ACL authorizer (uncomment for production)
#authorizer.class.name=kafka.security.auth.SimpleAclAuthorizer
#allow.everyone.if.no.acl.found=false
#super.users=User:admin

# =======================================
# KRaft Mode Settings (Alternative to Zookeeper)
# =======================================

# For KRaft mode, uncomment these and comment out Zookeeper settings
#process.roles=broker,controller
#node.id=1
#controller.quorum.voters=1@localhost:9093
#controller.listener.names=CONTROLLER
#metadata.log.dir=/var/lib/kafka/metadata

# =======================================
# Performance Tuning
# =======================================

# Message size limits
message.max.bytes=1048576
replica.fetch.max.bytes=1048576

# Request size limits
max.request.size=1048576

# Batch settings
batch.size=16384
linger.ms=1

# Buffer memory
buffer.memory=33554432

# =======================================
# Monitoring
# =======================================

# JMX options (set via environment variables)
# KAFKA_JMX_OPTS=-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false

# =======================================
# Log4j Settings
# =======================================

# Log levels (set via log4j.properties)
# log4j.rootLogger=INFO, stdout
# log4j.logger.kafka=INFO
# log4j.logger.org.apache.zookeeper=WARN